import{_ as V,r as m,o as h,c as p,b as o,a as e,f as y,F as C,e as E,t as d,w as _,n as u,g as k,h as L}from"./index-fffa9242.js";const{VITE_API:g,VITE_API_PATH:f}={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_API_PATH:"petshome",BASE_URL:"/vite-homework/",MODE:"production",DEV:!1,PROD:!0},x={data(){return{user:{},message:"",isLoading:!0,fullPage:!0,carts:[]}},mounted(){this.isLoading=!0,this.getCart()},methods:{getCart(){this.$http.get(`${g}api/${f}/cart`).then(a=>{const s=a.data.data.carts;this.carts=s,this.isLoading=!1}).catch(a=>console.log(a))},onSubmit(){if(this.carts.length>0){const a={data:{user:this.user,message:this.message}};this.$http.post(`${g}api/${f}/order`,a).then(s=>{alert("建立訂單"),this.$refs.form.resetForm(),this.user={},this.carts=[]})}else alert("請選購商品後再結帳")},deleteCart(a){a==="all"?this.carts.length>0?(this.isLoading=!0,this.$http.delete(`${g}api/${f}/carts`).then(s=>{s.data.success?(alert(s.data.message),this.getCart(),this.isLoading=!1):alert(s.data.message)}).catch(s=>console.log(s))):alert("購物車內無商品"):(this.isLoading=!0,this.$http.delete(`${g}api/${f}/cart/${a}`).then(s=>{s.data.success?(alert(s.data.message),this.getCart(),this.isLoading=!1):alert(s.data.message)}).catch(s=>console.log(s)))}},computed:{total(){let a=0;return this.carts.forEach(s=>{a+=s.final_total}),a}}},P={class:"col p-4"},A={key:0,class:"text-end mb-4"},I={class:"table align-middle table-sm"},T=e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",null,"數量/單位"),e("th",null,"單價")])],-1),F=["onClick"],N={class:"input-group"},U={colspan:"4",class:"text-end"},S={class:"form-floating mb-3"},q=e("label",{for:"name-input"},"Name",-1),w={class:"form-floating mb-3"},D=e("label",{for:"email-input"},"Email",-1),B={class:"form-floating mb-3"},M=e("label",{for:"telphone-input"},"Telphone",-1),$={class:"form-floating mb-3"},H=e("label",{for:"address-input"},"Address",-1),O={class:"form-floating mb-3"},R=e("label",{for:"message-input"},"Message",-1),z=e("div",{class:"text-end d-grid"},[e("button",{class:"btn btn-primary",type:"submit"},"送出")],-1);function X(a,s,j,G,t,c){const b=m("VueLoading"),i=m("VueField"),r=m("error-message"),v=m("VueForm");return h(),p("div",null,[o(b,{active:t.isLoading,"onUpdate:active":s[0]||(s[0]=l=>t.isLoading=l),"can-cancel":!1,"is-full-page":t.fullPage},null,8,["active","is-full-page"]),e("div",P,[t.carts.length>0?(h(),p("div",A,[e("button",{class:"btn btn-danger",type:"submit",onClick:s[1]||(s[1]=l=>c.deleteCart("all"))}," 清除購物車 ")])):y("",!0),e("table",I,[T,e("tbody",null,[(h(!0),p(C,null,E(t.carts,l=>(h(),p("tr",{key:l.id},[e("td",null,[e("button",{class:"btn btn-danger rounded-circle my-2",type:"button",onClick:n=>c.deleteCart(l.id)}," X ",8,F)]),e("td",null,d(l.product.title),1),e("td",null,[e("div",N,[e("span",null,d(l.qty)+" / "+d(l.product.unit),1)])]),e("td",null,"$"+d(l.product.price),1)]))),128)),e("tr",null,[e("td",U,"總共: $"+d(c.total),1)])])]),o(v,{ref:"form",class:"mt-5",onSubmit:c.onSubmit},{default:_(({errors:l})=>[e("div",S,[o(i,{id:"name",name:"userName",label:"姓名",type:"username",class:u(["form-control",{"is-invalid":l.userName}]),placeholder:"請輸入 username",rules:"required",modelValue:t.user.name,"onUpdate:modelValue":s[2]||(s[2]=n=>t.user.name=n)},null,8,["class","modelValue"]),q,o(r,{name:"userName",class:"invalid-feedback"})]),e("div",w,[o(i,{id:"email",name:"Email",type:"email",class:u(["form-control",{"is-invalid":l.Email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:t.user.email,"onUpdate:modelValue":s[3]||(s[3]=n=>t.user.email=n)},null,8,["class","modelValue"]),D,o(r,{name:"Email",class:"invalid-feedback"})]),e("div",B,[o(i,{id:"telphone",name:"tel",label:"電話",type:"tel",class:u(["form-control",{"is-invalid":l.tel}]),placeholder:"請輸入 telphone",rules:"min: 8|numeric|required",modelValue:t.user.tel,"onUpdate:modelValue":s[4]||(s[4]=n=>t.user.tel=n)},null,8,["class","modelValue"]),M,o(r,{name:"tel",class:"invalid-feedback"})]),e("div",$,[o(i,{id:"address",name:"address",label:"地址",type:"tel",class:u(["form-control",{"is-invalid":l.address}]),placeholder:"請輸入 address",rules:"min: 8|required",modelValue:t.user.address,"onUpdate:modelValue":s[5]||(s[5]=n=>t.user.address=n)},null,8,["class","modelValue"]),H,o(r,{name:"address",class:"invalid-feedback"})]),e("div",O,[o(i,{id:"message",name:"message"},{default:_(()=>[k(e("textarea",{type:"text",class:u(["form-control",{"is-invalid":l.message}]),style:{height:"100px"},"onUpdate:modelValue":s[6]||(s[6]=n=>t.message=n),placeholder:"請輸入 message"},null,2),[[L,t.message]])]),_:2},1024),R,o(r,{name:"message",class:"invalid-feedback"})]),z]),_:1},8,["onSubmit"])])])}const K=V(x,[["render",X]]);export{K as default};
