import{_ as v,r as c,o as m,c as h,b as o,a as e,f as V,F as y,e as C,t as r,w as E,n as p,g as k,h as L}from"./index-a63ab4b4.js";const{VITE_API:g,VITE_API_PATH:f}={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_API_PATH:"petshome",BASE_URL:"/vite-homework/",MODE:"production",DEV:!1,PROD:!0},x={data(){return{user:{},message:"",isLoading:!0,fullPage:!0,carts:[]}},mounted(){this.isLoading=!0,this.getCart()},methods:{getCart(){this.$http.get(`${g}api/${f}/cart`).then(a=>{const t=a.data.data.carts;this.carts=t,this.isLoading=!1}).catch(a=>console.log(a))},onSubmit(){if(this.carts.length>0){const a={data:{user:this.user,message:this.message}};this.$http.post(`${g}api/${f}/order`,a).then(t=>{alert("建立訂單"),this.$refs.form.resetForm(),this.user={},this.carts=[]})}else alert("請選購商品後再結帳")},deleteCart(a){a==="all"?this.carts.length>0?(this.isLoading=!0,this.$http.delete(`${g}api/${f}/carts`).then(t=>{t.data.success?(alert(t.data.message),this.getCart(),this.isLoading=!1):alert(t.data.message)}).catch(t=>console.log(t))):alert("購物車內無商品"):(this.isLoading=!0,this.$http.delete(`${g}api/${f}/cart/${a}`).then(t=>{t.data.success?(alert(t.data.message),this.getCart(),this.isLoading=!1):alert(t.data.message)}).catch(t=>console.log(t)))}},computed:{total(){let a=0;return this.carts.forEach(t=>{a+=t.final_total}),a}}},P={class:"col p-4"},A={key:0,class:"text-end mb-4"},I={class:"table align-middle table-sm"},T=e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",null,"數量/單位"),e("th",null,"單價")])],-1),F=["onClick"],U={class:"input-group"},S={colspan:"4",class:"text-end"},q={class:"form-floating mb-3"},w=e("label",{for:"username-input"},"Name",-1),D={class:"form-floating mb-3"},B=e("label",{for:"email-input"},"Email",-1),N={class:"form-floating mb-3"},M=e("label",{for:"telphone-input"},"Telphone",-1),$={class:"form-floating mb-3"},H=e("label",{for:"address-input"},"Address",-1),O={class:"form-floating mb-3"},R=e("label",{for:"message-input"},"Message",-1),z=e("div",{class:"text-end d-grid"},[e("button",{class:"btn btn-primary",type:"submit"},"送出")],-1);function X(a,t,j,G,s,d){const _=c("VueLoading"),u=c("VueField"),i=c("error-message"),b=c("VueForm");return m(),h("div",null,[o(_,{active:s.isLoading,"onUpdate:active":t[0]||(t[0]=l=>s.isLoading=l),"can-cancel":!1,"is-full-page":s.fullPage},null,8,["active","is-full-page"]),e("div",P,[s.carts.length>0?(m(),h("div",A,[e("button",{class:"btn btn-danger",type:"submit",onClick:t[1]||(t[1]=l=>d.deleteCart("all"))}," 清除購物車 ")])):V("",!0),e("table",I,[T,e("tbody",null,[(m(!0),h(y,null,C(s.carts,l=>(m(),h("tr",{key:l.id},[e("td",null,[e("button",{class:"btn btn-danger rounded-circle my-2",type:"button",onClick:n=>d.deleteCart(l.id)}," X ",8,F)]),e("td",null,r(l.product.title),1),e("td",null,[e("div",U,[e("span",null,r(l.qty)+" / "+r(l.product.unit),1)])]),e("td",null,"$"+r(l.product.price),1)]))),128)),e("tr",null,[e("td",S,"總共: $"+r(d.total),1)])])]),o(b,{ref:"form",class:"mt-5",onSubmit:d.onSubmit},{default:E(({errors:l})=>[e("div",q,[o(u,{id:"username",name:"account",label:"姓名",type:"username",class:p(["form-control",{"is-invalid":l.姓名}]),placeholder:"請輸入 username",rules:"required",modelValue:s.user.name,"onUpdate:modelValue":t[2]||(t[2]=n=>s.user.name=n)},null,8,["class","modelValue"]),w,o(i,{name:"account",class:"invalid-feedback"})]),e("div",D,[o(u,{id:"email",name:"Email",type:"email",class:p(["form-control",{"is-invalid":l.Email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:s.user.email,"onUpdate:modelValue":t[3]||(t[3]=n=>s.user.email=n)},null,8,["class","modelValue"]),B,o(i,{name:"Email",class:"invalid-feedback"})]),e("div",N,[o(u,{id:"telphone",name:"tel",label:"電話",type:"tel",class:p(["form-control",{"is-invalid":l.電話}]),placeholder:"請輸入 telphone",rules:"min: 8|numeric|required",modelValue:s.user.tel,"onUpdate:modelValue":t[4]||(t[4]=n=>s.user.tel=n)},null,8,["class","modelValue"]),M,o(i,{name:"tel",class:"invalid-feedback"})]),e("div",$,[o(u,{id:"address",name:"address",label:"地址",type:"tel",class:p(["form-control",{"is-invalid":l.地址}]),placeholder:"請輸入 address",rules:"min: 8|required",modelValue:s.user.address,"onUpdate:modelValue":t[5]||(t[5]=n=>s.user.address=n)},null,8,["class","modelValue"]),H,o(i,{name:"address",class:"invalid-feedback"})]),e("div",O,[k(e("textarea",{style:{height:"100px"},id:"message",name:"message",type:"text",class:"form-control",placeholder:"請輸入 message","onUpdate:modelValue":t[6]||(t[6]=n=>s.message=n)},null,512),[[L,s.message]]),R,o(i,{name:"message",class:"invalid-feedback"})]),z]),_:1},8,["onSubmit"])])])}const K=v(x,[["render",X]]);export{K as default};
